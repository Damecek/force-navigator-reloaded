<template lwc:render-mode="light">
  <section
    aria-labelledby="command-palette-heading"
    aria-modal="true"
    class="slds-modal slds-fade-in-open"
    role="dialog"
    tabindex="-1"
  >
    <div class="modal-container slds-modal__container">
      <button
        class="slds-button slds-button_icon slds-modal__close"
        onclick={handleClose}
      >
        <svg
          aria-hidden="true"
          class="slds-button__icon slds-button__icon_large"
          focusable="false"
          part="icon"
          viewBox="0 0 520 520"
        >
          <g>
            <path
              d="M310 254l130-131c6-6 6-15 0-21l-20-21c-6-6-15-6-21 0L268 212a10 10 0 01-14 0L123 80c-6-6-15-6-21 0l-21 21c-6 6-6 15 0 21l131 131c4 4 4 10 0 14L80 399c-6 6-6 15 0 21l21 21c6 6 15 6 21 0l131-131a10 10 0 0114 0l131 131c6 6 15 6 21 0l21-21c6-6 6-15 0-21L310 268a10 10 0 010-14z"
            ></path>
          </g>
        </svg>
        <span class="slds-assistive-text">Cancel and close</span>
      </button>
      <div class="slds-modal__header">
        <h1 class="slds-modal__title slds-hyphenate" tabindex="-1">
          Command Palette
        </h1>
      </div>
      <div class="slds-modal__content slds-p-around_medium">
        <div class="slds-form-element">
          <label class="slds-form-element__label">Command</label>
          <div class="slds-form-element__control">
            <div class="slds-combobox_container">
              <div
                aria-controls="command-listbox"
                aria-expanded="true"
                aria-haspopup="listbox"
                aria-labelledby="command-combobox-label"
                class="slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open"
                role="combobox"
              >
                <div
                  class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"
                  role="none"
                >
                  <input
                    aria-autocomplete="list"
                    aria-controls="command-listbox"
                    aria-labelledby="command-combobox-label"
                    autofocus
                    class="slds-input slds-combobox__input"
                    lwc:ref="input"
                    name="command-input"
                    oninput={handleInput}
                    onkeydown={handleKeyDown}
                    placeholder="Type a command..."
                    type="text"
                  />
                  <span
                    class="slds-icon_container slds-icon-utility-down slds-input__icon slds-input__icon_right"
                    title="Show commands"
                  >
                    <svg
                      aria-hidden="true"
                      class="slds-button__icon slds-button__icon_left"
                      data-key="search"
                      focusable="false"
                      part="icon"
                      viewBox="0 0 520 520"
                    >
                      <g>
                        <path
                          d="M496 453L362 320a189 189 0 10-340-92 190 190 0 00298 135l133 133a14 14 0 0021 0l21-21a17 17 0 001-22zM210 338a129 129 0 11130-130 129 129 0 01-130 130z"
                        ></path>
                      </g>
                    </svg>
                  </span>
                </div>
                <div
                  aria-label="Commands"
                  class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid"
                  role="listbox"
                  lwc:ref="listbox"
                  onscroll={handleScroll}
                >
                  <ul
                    class="slds-listbox slds-listbox_vertical"
                    role="presentation"
                    style={listStyle}
                  >
                    <template for:each={items} for:item="item">
                      <li
                        class="slds-listbox__item"
                        data-index={item.idx}
                        key={item.cmd.id}
                        style={item.style}
                        onmouseover={handleMouseOver}
                      >
                        <x-command-item
                          command={item.cmd}
                          data-highlighted={item.isSelected}
                          highlighted={item.isSelected}
                        ></x-command-item>
                      </li>
                    </template>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
</template>
